<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Solución Parcial II - Ejercicio 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="solucion ejercicio 1_files/libs/clipboard/clipboard.min.js"></script>
<script src="solucion ejercicio 1_files/libs/quarto-html/quarto.js"></script>
<script src="solucion ejercicio 1_files/libs/quarto-html/popper.min.js"></script>
<script src="solucion ejercicio 1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="solucion ejercicio 1_files/libs/quarto-html/anchor.min.js"></script>
<link href="solucion ejercicio 1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="solucion ejercicio 1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="solucion ejercicio 1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="solucion ejercicio 1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="solucion ejercicio 1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#códigos-previos" id="toc-códigos-previos" class="nav-link active" data-scroll-target="#códigos-previos"><span class="header-section-number">1</span> Códigos previos</a>
  <ul class="collapse">
  <li><a href="#paquetes" id="toc-paquetes" class="nav-link" data-scroll-target="#paquetes"><span class="header-section-number">1.1</span> Paquetes</a></li>
  <li><a href="#lectura-de-los-datos" id="toc-lectura-de-los-datos" class="nav-link" data-scroll-target="#lectura-de-los-datos"><span class="header-section-number">1.2</span> Lectura de los datos</a></li>
  </ul></li>
  <li><a href="#análisis-descriptivo" id="toc-análisis-descriptivo" class="nav-link" data-scroll-target="#análisis-descriptivo"><span class="header-section-number">2</span> Análisis descriptivo</a>
  <ul class="collapse">
  <li><a href="#acf-y-pacf" id="toc-acf-y-pacf" class="nav-link" data-scroll-target="#acf-y-pacf"><span class="header-section-number">2.1</span> ACF y PACF</a></li>
  <li><a href="#modelos-sin-diferenciación" id="toc-modelos-sin-diferenciación" class="nav-link" data-scroll-target="#modelos-sin-diferenciación"><span class="header-section-number">2.2</span> Modelos sin diferenciación</a></li>
  <li><a href="#criterio-de-información" id="toc-criterio-de-información" class="nav-link" data-scroll-target="#criterio-de-información"><span class="header-section-number">2.3</span> Criterio de información</a></li>
  <li><a href="#diagnóstico" id="toc-diagnóstico" class="nav-link" data-scroll-target="#diagnóstico"><span class="header-section-number">2.4</span> Diagnóstico</a></li>
  <li><a href="#modelos-con-diferenciación" id="toc-modelos-con-diferenciación" class="nav-link" data-scroll-target="#modelos-con-diferenciación"><span class="header-section-number">2.5</span> Modelos con diferenciación</a></li>
  <li><a href="#auto.arima" id="toc-auto.arima" class="nav-link" data-scroll-target="#auto.arima"><span class="header-section-number">2.6</span> auto.arima</a>
  <ul class="collapse">
  <li><a href="#modelo-final" id="toc-modelo-final" class="nav-link" data-scroll-target="#modelo-final"><span class="header-section-number">2.6.1</span> Modelo Final</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Solución Parcial II - Ejercicio 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="códigos-previos" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Códigos previos</h1>
<section id="paquetes" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="paquetes"><span class="header-section-number">1.1</span> Paquetes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSA)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lectura-de-los-datos" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="lectura-de-los-datos"><span class="header-section-number">1.2</span> Lectura de los datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">"turistas.RData"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>nacionales <span class="ot">&lt;-</span> <span class="fu">ts</span>(turistas<span class="sc">$</span>nacional, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">2002</span>,<span class="dv">1</span>),<span class="at">frequency=</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="análisis-descriptivo" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Análisis descriptivo</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(nacionales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El gráfico lineal muestra que la serie tiene tendencia creciente y con una estacionalidad anual. La variabilidad es aditiva pues no presenta variación estacional proporcional de acuerdo con el nivel de la serie. Como no presenta media constante, la serie no es estacionaria.</p>
<section id="acf-y-pacf" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="acf-y-pacf"><span class="header-section-number">2.1</span> ACF y PACF</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>astsa<span class="sc">::</span><span class="fu">acf2</span>(nacionales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2] [,3] [,4]  [,5]  [,6] [,7]  [,8]  [,9] [,10] [,11] [,12] [,13]
ACF  0.55  0.22 0.13 0.24  0.19  0.02 0.13  0.20  0.09  0.13  0.37  0.66  0.33
PACF 0.55 -0.12 0.08 0.23 -0.09 -0.10 0.30 -0.05 -0.15  0.37  0.30  0.35 -0.39
     [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
ACF   0.04 -0.04  0.08  0.01 -0.13 -0.04 -0.02 -0.08 -0.09  0.10  0.31  0.06
PACF -0.07 -0.12 -0.09 -0.12  0.00 -0.03 -0.20  0.06 -0.12 -0.03 -0.02 -0.03
     [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
ACF  -0.11 -0.19 -0.10 -0.17 -0.25 -0.17 -0.15 -0.21 -0.21 -0.08  0.10 -0.07
PACF  0.14 -0.11 -0.05 -0.02  0.05 -0.08  0.06 -0.06  0.00 -0.10  0.06 -0.01
     [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
ACF  -0.18 -0.22 -0.14 -0.18 -0.22 -0.18 -0.14 -0.15 -0.15 -0.09  0.00
PACF -0.10  0.10 -0.01  0.05 -0.04 -0.06  0.10  0.07 -0.02 -0.15 -0.02</code></pre>
</div>
</div>
</section>
<section id="modelos-sin-diferenciación" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="modelos-sin-diferenciación"><span class="header-section-number">2.2</span> Modelos sin diferenciación</h2>
<p>Como la serie no es estacionaria, la acf y pacf no son confiables. Sin embargo, las estructuras de la acf y la pacf parecen que decaen rápido a cero. Por lo que si no se realiza diferenciación, recomiendan AR(1) (asumiendo un rezago en la pacf), MA(1) (asumiendo un rezago en la acf), o bien ARMA(1,1) (decaimiento exponencial en ambas) en la parte no estacional, mientras que para la parte estacional, al tener dos rezagos en los rezagos múltiplos de 12 en la acf y 1 rezago en la pacf, se concluye que SAR(1), podría ser adecuado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mod2<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mod3<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(1,0,0)(1,0,0)[12] with non-zero mean 

Coefficients:
         ar1    sar1       mean
      0.6030  0.8772  410250.02
s.e.  0.1017  0.0451   31370.17

sigma^2 = 576810697:  log likelihood = -697.82
AIC=1403.64   AICc=1404.37   BIC=1412.02

Training set error measures:
                   ME     RMSE   MAE       MPE     MAPE      MASE      ACF1
Training set 5517.038 23408.76 17752 0.9501409 4.415755 0.6937462 -0.261406</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(0,0,1)(1,0,0)[12] with non-zero mean 

Coefficients:
         ma1    sar1       mean
      0.4073  0.8675  409168.77
s.e.  0.0958  0.0497   18760.97

sigma^2 = 714566378:  log likelihood = -703.68
AIC=1415.37   AICc=1416.1   BIC=1423.75

Training set error measures:
                   ME     RMSE      MAE      MPE     MAPE      MASE       ACF1
Training set 8826.153 26054.52 21009.87 1.634992 5.187461 0.8210636 0.03550305</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(1,0,1)(1,0,0)[12] with non-zero mean 

Coefficients:
         ar1      ma1    sar1       mean
      0.9696  -0.7899  0.9227  417988.64
s.e.  0.0271   0.0922  0.0303   87697.34

sigma^2 = 4.13e+08:  log likelihood = -691.07
AIC=1392.15   AICc=1393.26   BIC=1402.62

Training set error measures:
                   ME     RMSE      MAE      MPE     MAPE      MASE        ACF1
Training set 3989.702 19632.28 14651.04 0.705163 3.579841 0.5725613 -0.03503782</code></pre>
</div>
</div>
<p>Los tres modelos muestran coeficientes significativos, y además para cada polinomio (autorregresivo, autorregresivo estacional y medias móviles), presentan raíces fuera del círculo unitario. Además, el intervalo de confianza de cada coeficiente no incluye a 1. Por lo que se cumplen condiciones de estacionariedad e invertibilidad. También se puede confirmar con los siguientes gráficos. Nota: los gráficos son engañosos por la cantidad de raíces que se encuentran cerca de 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="criterio-de-información" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="criterio-de-información"><span class="header-section-number">2.3</span> Criterio de información</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mod1<span class="sc">$</span>aicc,mod1<span class="sc">$</span>bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1404.371 1412.021</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mod2<span class="sc">$</span>aicc,mod2<span class="sc">$</span>bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1416.097 1423.747</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mod3<span class="sc">$</span>aicc,mod3<span class="sc">$</span>bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1393.257 1402.618</code></pre>
</div>
</div>
<p>Los dos criterios de información recomiendan al modelo <span class="math inline">\(SARIMA(1,0,1)(1,0,0)_{12}\)</span>.</p>
</section>
<section id="diagnóstico" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="diagnóstico"><span class="header-section-number">2.4</span> Diagnóstico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(1,0,1)(1,0,0)[12] with non-zero mean
Q* = 12.402, df = 9, p-value = 0.1916

Model df: 3.   Total lags used: 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mod3<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  mod3$residuals
W = 0.95277, p-value = 0.02106</code></pre>
</div>
</div>
<p>La variabilidad de los errores parece ser constante en el tiempo y no tiene autocorrelación. El único supuesto que no se cumple es la normalidad, lo cual no afecta a la estimación de los coeficientes, pero sí a la construcción del intervalo de confianza de las predicciones.</p>
</section>
<section id="modelos-con-diferenciación" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="modelos-con-diferenciación"><span class="header-section-number">2.5</span> Modelos con diferenciación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>astsa<span class="sc">::</span><span class="fu">acf2</span>(<span class="fu">diff</span>(nacionales),<span class="at">max.lag =</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2]  [,3]  [,4]  [,5]  [,6] [,7] [,8]  [,9] [,10] [,11] [,12] [,13]
ACF  -0.1 -0.26 -0.27  0.17  0.13 -0.30 0.09 0.14 -0.16 -0.23 -0.06  0.72 -0.03
PACF -0.1 -0.28 -0.37 -0.03 -0.03 -0.41 0.04 0.03 -0.48 -0.38 -0.51  0.18 -0.09
     [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
ACF  -0.23 -0.22  0.15  0.10 -0.23  0.10  0.05 -0.09 -0.21  0.01  0.51 -0.06
PACF -0.09  0.02 -0.02 -0.13  0.02  0.15 -0.12  0.03  0.01 -0.05 -0.05 -0.18
     [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
ACF  -0.10 -0.18  0.13  0.03 -0.16  0.09  0.03 -0.06 -0.15 -0.01  0.37 -0.04
PACF  0.05 -0.03 -0.09 -0.05 -0.01 -0.21 -0.03  0.02  0.00 -0.09  0.05  0.12
     [,38] [,39] [,40]
ACF  -0.06 -0.15  0.08
PACF -0.08 -0.05  0.00</code></pre>
</div>
</div>
<p>Al realizar una diferenciación, la acf y pacf muestran que no hay estructura para la parte no estacional, pero un decaimiento de acf en los rezagos múltiplos de 12, lo cual implica que podría ser un SAR(1) o requiere diferenciación estacional.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(0,1,0)(1,0,0)[12] 

Coefficients:
        sar1
      0.8713
s.e.  0.0463

sigma^2 = 703341917:  log likelihood = -692.71
AIC=1389.42   AICc=1389.64   BIC=1393.58

Training set error measures:
                   ME     RMSE      MAE         MPE     MAPE      MASE
Training set 742.3536 26074.84 18926.84 -0.08999404 4.752816 0.7396588
                   ACF1
Training set -0.4316173</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,1,0)(1,0,0)[12]
Q* = 23.643, df = 11, p-value = 0.01432

Model df: 1.   Total lags used: 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>astsa<span class="sc">::</span><span class="fu">acf2</span>(mod4<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4] [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
ACF  -0.43  0.01 -0.13  0.00 0.17 -0.11 -0.13  0.18 -0.11  0.06  0.09 -0.19
PACF -0.43 -0.21 -0.27 -0.27 0.00 -0.08 -0.30 -0.04 -0.14 -0.20  0.08 -0.13
     [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
ACF   0.29 -0.27  0.06 -0.01 -0.04  0.09  0.05 -0.13  0.11 -0.22  0.24 -0.07
PACF  0.16 -0.01 -0.05 -0.06 -0.08 -0.06  0.12  0.03 -0.01 -0.23 -0.02 -0.15
     [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
ACF  -0.08  0.12 -0.08  0.08 -0.03 -0.09  0.14 -0.05  0.00 -0.07 -0.10  0.27
PACF -0.13  0.00  0.00 -0.01 -0.04 -0.12  0.00 -0.01  0.17 -0.10 -0.18 -0.03
     [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
ACF  -0.06 -0.03 -0.06  0.05  0.00  0.08 -0.17  0.08 -0.05  0.05  0.02 -0.05
PACF -0.02  0.02 -0.03  0.12 -0.06  0.04  0.02 -0.12  0.04  0.01  0.04  0.07</code></pre>
</div>
</div>
<p>El mod4 indica que el coeficiente de SAR(1) es significativo y se cumple el supuesto de estacionariedad e invertibilidad, pero la acf y pacf de los residuales indican que hay una estructura AR(1), MA(1) o ARMA(1,1) que no fue contemplado, pues hay un rezago significativo en la acf y pacf, respectivamente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mod5<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mod6<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(1,1,0)(1,0,0)[12] 

Coefficients:
          ar1    sar1
      -0.4798  0.9205
s.e.   0.1172  0.0322

sigma^2 = 5.12e+08:  log likelihood = -685.7
AIC=1377.39   AICc=1377.83   BIC=1383.62

Training set error measures:
                   ME     RMSE      MAE         MPE     MAPE      MASE
Training set 869.0752 22055.54 15224.51 -0.04272103 3.774315 0.5949722
                   ACF1
Training set -0.1175996</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(0,1,1)(1,0,0)[12] 

Coefficients:
          ma1    sar1
      -0.8435  0.9243
s.e.   0.0712  0.0298

sigma^2 = 396375121:  log likelihood = -678.79
AIC=1363.57   AICc=1364.01   BIC=1369.81

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE      MASE
Training set 2894.459 19405.06 14650.95 0.4922547 3.568518 0.5725578
                    ACF1
Training set 0.003829608</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(1,1,1)(1,0,0)[12] 

Coefficients:
         ar1      ma1    sar1
      0.0465  -0.8567  0.9210
s.e.  0.1657   0.0815  0.0329

sigma^2 = 406582389:  log likelihood = -678.75
AIC=1365.49   AICc=1366.23   BIC=1373.8

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE      MASE
Training set 3022.229 19480.17 14671.29 0.5209381 3.574442 0.5733523
                    ACF1
Training set -0.02869138</code></pre>
</div>
</div>
<p>Los mod5 y mod6 tienen coeficientes significativos pero mod7 tiene el coeficiente ar1 no significativo, lo cual implica que el modelo más adecuado es usando un coeficiente, ya sea AR1 o MA1. Usando AIC y BIC, el mod6 es más adecuado.</p>
<p>Si también se realiza una diferenciación estacional, se tiene la acf y pacf:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>astsa<span class="sc">::</span><span class="fu">acf2</span>(<span class="fu">diff</span>(<span class="fu">diff</span>(nacionales),<span class="dv">12</span>),<span class="at">max.lag =</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
ACF  -0.56  0.11 -0.04 -0.09  0.18 -0.12 -0.08  0.18 -0.16  0.13  0.16 -0.38
PACF -0.56 -0.29 -0.20 -0.31 -0.08 -0.07 -0.28 -0.07 -0.13 -0.09  0.39  0.04
     [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
ACF   0.30 -0.27  0.21 -0.09 -0.05  0.12  0.05 -0.15  0.11 -0.17  0.22 -0.14
PACF  0.15 -0.03  0.03 -0.13 -0.11 -0.09  0.09  0.01 -0.07 -0.19  0.17 -0.01
     [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
ACF  -0.09  0.19 -0.11  0.10 -0.04 -0.02  0.00 -0.04  0.06  0.03 -0.15  0.15
PACF -0.11 -0.10 -0.02 -0.14 -0.11 -0.04  0.03 -0.05  0.10 -0.03  0.06  0.01
     [,37] [,38] [,39] [,40]
ACF  -0.02  0.00 -0.02 -0.03
PACF  0.04 -0.07 -0.04 -0.06</code></pre>
</div>
</div>
<p>La acf y pacf muestran decaimiento rápido tanto en la parte estacional como no estacional. Modelos posibles son: <span class="math inline">\(SARIMA(1,1,0)(0,1,1)_{12}\)</span> <span class="math inline">\(SARIMA(0,1,1)(0,1,1)_{12}\)</span> <span class="math inline">\(SARIMA(1,1,1)(0,1,1)_{12}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mod8<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>mod9<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>mod10<span class="ot">=</span>forecast<span class="sc">::</span><span class="fu">Arima</span>(nacionales,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>) ,<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(1,1,0)(0,1,1)[12] 

Coefficients:
          ar1     sma1
      -0.5204  -0.8017
s.e.   0.1231   0.4152

sigma^2 = 318617059:  log likelihood = -531.38
AIC=1068.76   AICc=1069.32   BIC=1074.32

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE      MASE       ACF1
Training set 1441.734 15458.42 10243.22 0.2187168 2.404984 0.4003041 -0.1577043</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
          ma1     sma1
      -0.8041  -0.7738
s.e.   0.0899   0.3698

sigma^2 = 261361678:  log likelihood = -526.67
AIC=1059.34   AICc=1059.9   BIC=1064.89

Training set error measures:
                   ME     RMSE      MAE       MPE    MAPE      MASE       ACF1
Training set 2876.392 14000.76 9064.274 0.5931288 2.13286 0.3542309 -0.1040494</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(1,1,1)(0,1,1)[12] 

Coefficients:
          ar1      ma1     sma1
      -0.0700  -0.7802  -0.7612
s.e.   0.1763   0.1130   0.3502

sigma^2 = 268871954:  log likelihood = -526.59
AIC=1061.18   AICc=1062.14   BIC=1068.58

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE      MASE
Training set 2856.424 14041.82 9154.291 0.5861671 2.153331 0.3577488
                    ACF1
Training set -0.05440456</code></pre>
</div>
</div>
<p>Nuevamente se observa que no es necesario estimar una estructura ARMA(1,1) pues el coeficiente AR1 no es significativo. Por lo que se escoge el mod9 por su criterio de información.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(mod9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,1,1)(0,1,1)[12]
Q* = 6.2248, df = 10, p-value = 0.796

Model df: 2.   Total lags used: 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>astsa<span class="sc">::</span><span class="fu">acf2</span>(mod9<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solucion-ejercicio-1_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2]  [,3]  [,4] [,5]  [,6]  [,7] [,8]  [,9] [,10] [,11] [,12] [,13]
ACF  -0.1 -0.01 -0.07 -0.10 0.14 -0.09  0.00 0.07 -0.03  0.12  0.12 -0.03 -0.04
PACF -0.1 -0.02 -0.08 -0.12 0.11 -0.07 -0.03 0.08  0.00  0.09  0.18  0.01 -0.05
     [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
ACF  -0.23  0.05 -0.02  0.03  0.11  0.03 -0.16 -0.01 -0.16  0.02 -0.10 -0.19
PACF -0.19  0.00 -0.07  0.00  0.09  0.09 -0.22 -0.05 -0.17 -0.06 -0.09 -0.16
     [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
ACF   0.10  0.06  0.02  0.02 -0.08 -0.03 -0.03 -0.02 -0.04 -0.09  0.07 -0.01
PACF -0.02  0.07 -0.08  0.00 -0.01  0.02  0.05  0.08 -0.13 -0.08 -0.02 -0.08
     [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
ACF   0.03  0.04 -0.03  0.02 -0.04  0.00  0.08  0.02  0.00  0.01  0.02
PACF -0.08  0.04  0.01  0.02 -0.08  0.02 -0.01 -0.01 -0.03  0.00 -0.03</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mod9<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  mod9$residuals
W = 0.91414, p-value = 0.000449</code></pre>
</div>
</div>
<p>Este modelo se cumple la homoscedasticidad y la independencia de los errores, pero la normalidad no. Cabe destacar que hay el rezago 3 significativo de la pacf es significativo (posiblemente 5 también) pero se omite por ser 1 o 2 de 4*12=48 rezagos (menos de 5%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mod3<span class="sc">$</span>aicc,mod3<span class="sc">$</span>bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1393.257 1402.618</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mod6<span class="sc">$</span>aicc,mod6<span class="sc">$</span>bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1364.009 1369.806</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mod9<span class="sc">$</span>aicc,mod9<span class="sc">$</span>bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1059.898 1064.890</code></pre>
</div>
</div>
<p>El modelo con los CI más bajos es el modelo <span class="math inline">\(SARIMA(0,1,1)(0,1,1)_{12}\)</span>.</p>
</section>
<section id="auto.arima" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="auto.arima"><span class="header-section-number">2.6</span> auto.arima</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>mod.auto<span class="ot">=</span><span class="fu">auto.arima</span>(nacionales)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.auto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(0,0,0)(1,1,0)[12] with drift 

Coefficients:
         sar1      drift
      -0.4415  2002.2384
s.e.   0.1499   168.0613

sigma^2 = 339882584:  log likelihood = -539.84
AIC=1085.69   AICc=1086.24   BIC=1091.3

Training set error measures:
                    ME     RMSE      MAE        MPE     MAPE      MASE
Training set -869.4848 16142.39 11539.15 -0.4226633 2.839115 0.4509486
                  ACF1
Training set 0.1137659</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mod9<span class="sc">$</span>aicc,mod9<span class="sc">$</span>bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1059.898 1064.890</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mod.auto<span class="sc">$</span>aicc,mod.auto<span class="sc">$</span>bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1086.235 1091.304</code></pre>
</div>
</div>
<p>Se puede ver que el mod8 es superior al modelo seleccionado por auto.arima, en término de los CI.</p>
<section id="modelo-final" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="modelo-final"><span class="header-section-number">2.6.1</span> Modelo Final</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: nacionales 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
          ma1     sma1
      -0.8041  -0.7738
s.e.   0.0899   0.3698

sigma^2 = 261361678:  log likelihood = -526.67
AIC=1059.34   AICc=1059.9   BIC=1064.89

Training set error measures:
                   ME     RMSE      MAE       MPE    MAPE      MASE       ACF1
Training set 2876.392 14000.76 9064.274 0.5931288 2.13286 0.3542309 -0.1040494</code></pre>
</div>
</div>
<p>El modelo final es <span class="math inline">\(SARIMA(0,1,1)(0,1,1)_{12}\)</span> y el modelo se escribe como:</p>
<p><span class="math display">\[ \nabla^1 \nabla_{12}^1 \tilde{Z}_t=\Theta_Q(B^s) \theta_q(B)a_t.\]</span> donde <span class="math inline">\(\theta(B)=1-0.8041 B\)</span> es el operador MA no estacional, <span class="math inline">\(\nabla^1\)</span> es el operador de diferenciación no estacional, <span class="math inline">\(\Theta(B^{12})=1-0.7738 B^{12}\)</span> es el operador MA estacional y <span class="math inline">\(\nabla_{12}^1\)</span> es el operador de diferenciación estacional. Como no tiene estructura de AR y SAR, entonces <span class="math inline">\(\phi(B)=1\)</span> y <span class="math inline">\(\Phi(B^s)=1\)</span>.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>